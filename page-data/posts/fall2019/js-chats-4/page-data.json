{
    "componentChunkName": "component---src-components-post-post-template-js",
    "path": "/posts/fall2019/js-chats-4/",
    "result": {"data":{"markdownRemark":{"html":"<ul>\n<li><a href=\"#an-introduction-to-%22frontend-optimization%22\">An Introduction to \"Frontend Optimization\"</a>\n<ul>\n<li><a href=\"#how-does-a-webpage-load\">How Does a Webpage Load?</a></li>\n<li><a href=\"#profiling-performance-with-chrome-devtools\">Profiling Performance with Chrome DevTools</a></li>\n</ul>\n</li>\n<li><a href=\"#optimizing-initial-rendering-of-react-application\">Optimizing Initial Rendering of React Application</a></li>\n<li><a href=\"#optimizing-runtime-of-react-application\">Optimizing Runtime of React Application</a>\n<ul>\n<li><a href=\"#shouldcomponentupdate-lifecycle-method\"><code class=\"language-text\">shouldComponentUpdate</code> Lifecycle Method</a></li>\n<li><a href=\"#reactpurecomponent\"><code class=\"language-text\">React.PureComponent</code></a></li>\n<li><a href=\"#reactmemo-for-function-components\"><code class=\"language-text\">React.memo</code> for Function Components</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"an-introduction-to-frontend-optimization\" style=\"position:relative;\"><a href=\"#an-introduction-to-frontend-optimization\" aria-label=\"an introduction to frontend optimization permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>An Introduction to \"Frontend Optimization\"</h2>\n<p>When talk about a piece of software, we usually\ncan optimize it in 2 dimensions.</p>\n<ul>\n<li>Can we reduce the run time? (time domain)</li>\n<li>Can we minimize memory usage? (space domain)</li>\n</ul>\n<p>In the frontend happy land, we usually do not care too much\nabout memory usage. People are fine (to a certain extent)\nwith Chrome eating up all your memory.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/470c2fe23c3faaeb4546d3d6b9a84532/4b190/chrome-mem.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.44171779141104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBf/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHtTSwVX//EABoQAAICAwAAAAAAAAAAAAAAAAIQAAERITH/2gAIAQEAAQUC6ZbWJa//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAaEAABBQEAAAAAAAAAAAAAAAARAAESICGB/9oACAEBAAY/AjLibRX/xAAaEAEBAQADAQAAAAAAAAAAAAABEQAhMUGB/9oACAEBAAE/IYpSBM69+uPcP3JuA4Ib/9oADAMBAAIAAwAAABAoD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/EIf/xAAZEAEBAQEBAQAAAAAAAAAAAAABESEAMXH/2gAIAQEAAT8QyVwDD7xpg02nx0KaBx5KY1913olPGmziAO//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Chrome Memory Eating meme\"\n        title=\"Chrome Memory Eating meme\"\n        src=\"/static/470c2fe23c3faaeb4546d3d6b9a84532/6aca1/chrome-mem.jpg\"\n        srcset=\"/static/470c2fe23c3faaeb4546d3d6b9a84532/d2f63/chrome-mem.jpg 163w,\n/static/470c2fe23c3faaeb4546d3d6b9a84532/c989d/chrome-mem.jpg 325w,\n/static/470c2fe23c3faaeb4546d3d6b9a84532/6aca1/chrome-mem.jpg 650w,\n/static/470c2fe23c3faaeb4546d3d6b9a84532/4b190/chrome-mem.jpg 800w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>However, we still care about sizes. Larger file size means\nhigher network latency to download files, which is\nrelated to the time domain.</p>\n<p>What are parts of a webpage we can optimize then?\nTo answer that question, we want to know how we measure\n\"performance\" of a webpage. What are some metrics that\nwe can use? The first instinct is probably</p>\n<blockquote>\n<p>How fast does our webpage load?</p>\n</blockquote>\n<p>This question is really generic. Where is the starting point\nof our measurement? Where is the ending point of our measurement?\nHow do we define \"finished loading\"? We will get into each one\nof them one by one.</p>\n<h3 id=\"how-does-a-webpage-load\" style=\"position:relative;\"><a href=\"#how-does-a-webpage-load\" aria-label=\"how does a webpage load permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How Does a Webpage Load?</h3>\n<blockquote>\n<p>What happens after you type in a URL in the browser and hit enter?</p>\n</blockquote>\n<p>If you have taken a network class, this is probably one of\nyour homework or exam question. Our introductory web development\nworkshops series Hackschool gives\n<a href=\"https://github.com/uclaacm/hackschool-f19/tree/master/session-1-intro-to-frontend#what-happens-when-you-type-a-url-and-hit-enter\">the following answer</a>:</p>\n<blockquote>\n<p>So when you type in a domain name from your computer, you are\nmaking a request to a server with that corresponding address.</p>\n</blockquote>\n<p>That is a simple explanation for getting our html file.\nIn fact, the time that it takes to get the first byte of the\nhtml file from the server starting from the moment you\nhit enter is called <strong>time to first byte</strong> (TTFB).\nThis is one of the metrics that we can use to measure\nthe performance of a webpage.</p>\n<p>However, this is not enough, getting the first byte does\nnot necessarily mean that the user can actually see the\npage. The browser has to first download the entire html file,\nthen combine it with style information (CSS) to render it\non the screen. This process of downloading and processing\ntakes time. The time taken until the content is visible\nto the user is <strong>first meaningful paint</strong> (FMP).\nThis is a better metrics than TTFB since TTFB really only\ndepends on how good the network is, but FMP takes into\nconsideration of time taken to render/draw the page.</p>\n<p>Drawing a page does not mean all the interactive functionality\nworks, which includes clicking buttons or user inputs.\nWe know that JavaScript is what makes a webpage interactive.\nTherefore, the time to get the page interactive is the time\nto run all the JavaScript and attaching all necessary event\nhandlers to each HTML DOM node. This time is called\ntime to interactive (TTI).</p>\n<p>In summary, the 3 metrics can be summarized in the following\ndiagram.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/958ba5de9cb6f8e899c08208e475bdfe/019a6/ttfb-fmp-tti.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.18404907975462%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAABpUlEQVQ4y5WUy3LDIAxF/f9/2VW6SOIGbJBA6HYEwa+4aesZDbItji4CMUAVZmoj+rh/9Pl/a2ePfR+608b2oxTBOI5gZpRS3oItZp5npJRqzLDCVpUGsSCzDs05n6oiInjvl8QVWDGFoIWrupBbEgoTYpgRiXC/3+Gcw+12q76I1BhTZtDuD1iADKAFxSQAOyR/3akxlSEExBgxTVNNcLlcaoKudlkyCsOx4IuBmAugguhHhNmDmUAxIhGBiepEU2NzLYn5tmQrz7DUrhCSCEgM2JLcHw4fn1dMSeEp48EF5VBDW3qv8wrMHpoeJrPudK+hixkjAz4DVwJcAlgUZXN0zoF9U1Qq0CaJAj4EeEqYs8KnpjyKIlWZvwK5ArcHkuMEzRMgDshmjwX0B4UGLM3vQJohaQYkQLNrpth1y3vgU6WWXHeZo0ORdqC1m/5FoT6XaQrre9tLOy69A/TZ870kb4DYNftuyZxegf9RqLubB7Ujeosdb5gjsLfgsCbVl4Jbm/VL4Seg/TegmfnDGnCe/bgJx5jtTVTvw12tTyacwd59/wbsUI6YIc4YAgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"network diagram to show TTFB, FMP, TTI\"\n        title=\"network diagram to show TTFB, FMP, TTI\"\n        src=\"/static/958ba5de9cb6f8e899c08208e475bdfe/a6d36/ttfb-fmp-tti.png\"\n        srcset=\"/static/958ba5de9cb6f8e899c08208e475bdfe/222b7/ttfb-fmp-tti.png 163w,\n/static/958ba5de9cb6f8e899c08208e475bdfe/ff46a/ttfb-fmp-tti.png 325w,\n/static/958ba5de9cb6f8e899c08208e475bdfe/a6d36/ttfb-fmp-tti.png 650w,\n/static/958ba5de9cb6f8e899c08208e475bdfe/e548f/ttfb-fmp-tti.png 975w,\n/static/958ba5de9cb6f8e899c08208e475bdfe/3c492/ttfb-fmp-tti.png 1300w,\n/static/958ba5de9cb6f8e899c08208e475bdfe/019a6/ttfb-fmp-tti.png 1818w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Do not get deceived by the diagram. Here is a question for you:</p>\n<blockquote>\n<p>In what situation will TTI equal FMP?</p>\n</blockquote>\n<h3 id=\"profiling-performance-with-chrome-devtools\" style=\"position:relative;\"><a href=\"#profiling-performance-with-chrome-devtools\" aria-label=\"profiling performance with chrome devtools permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Profiling Performance with Chrome DevTools</h3>\n<p>We have just looked at some metrics that we can use.\nWith the help the Chrome DevTools, we can profile a webpage\neasily. Open Chrome DevTools and go to the \"Performance\" tab.\nIf you hit the circle button on the top left corner,\nyou can profile the current web page.\nWhat Chrome will do is that it reloads the webpage and\ntries to time things.</p>\n<p>For a complete guide on how to use the Performance tab, read\n<a href=\"https://developers.google.com/web/tools/chrome-devtools/evaluate-performance\">Google's official introductory article</a>.</p>\n<p>The Performance tab focuses on benchmarking our website\nfrom a developer/programmer's perspective, where we look\nat numbers like TTFB, CPU time distribution, memory\nusage, time for each call stack, network requests waterfall,\netc. These all focus on speed, but there are other\nparts of user experience. How readable are the text on the\nbackground? How accessible is our website for user that\nuses the accessibility features in the browser?\nHow search engine friendly is our website?</p>\n<p>To measure these performance, we use the \"Audit\" tab.\nRead the official guide\n<a href=\"https://developers.google.com/web/tools/lighthouse#devtools\">here</a>.</p>\n<h2 id=\"optimizing-initial-rendering-of-react-application\" style=\"position:relative;\"><a href=\"#optimizing-initial-rendering-of-react-application\" aria-label=\"optimizing initial rendering of react application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Optimizing Initial Rendering of React Application</h2>\n<p>The rendering process of a React application is very\ndifferent from a static site.\nTake for example, the emoji search web application:\n<a href=\"https://ahfarmer.github.io/emoji-search/\">https://ahfarmer.github.io/emoji-search/</a>.\nIf we go to the network tab in Chrome DevTools,\nwe can see the first html file being requested.\nHere is the response body (prettified):</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\">lang</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>en<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>viewport<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">content</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>width=device-width,initial-scale=1<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>manifest<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/emoji-search/manifest.json<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>shortcut icon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/emoji-search/favicon.ico<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Emoji Search <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/emoji-search/static/css/main.2e862781.css<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>noscript</span><span class=\"token punctuation\">></span></span>You need to enable JavaScript to run this app.\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>noscript</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>root<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>github-fork-ribbon<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://github.com/ahfarmer/emoji-search<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Fork me on GitHub<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Fork me on GitHub<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text/javascript<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/emoji-search/static/js/main.d4350923.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>This file does not contain whatever content should be on the page.\nIt only contains an <code class=\"language-text\">a</code> tag and nothing else.\nWhat happened to the rest of the content that we see in the browser?\nRemember that everything written within React is actually in the\nspace of JavaScript, not in the space of HTML.\nOur React application is actually sitting in the script at the end\nof the file. What is the implication of this?</p>\n<p>From the timeline in the Performance tab, we can see that the\nrequest for the javascript file only fired after the request\nfor HTML and after the browser has finished analyzing the\nHTML file for tags.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4c80cb81af8b0f10293790437d23fff5/92bb4/react-network-waterfall.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.65030674846626%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABcklEQVQoz3WRS4vbQBCE9f//Uw455BYWAjE44Kyl+K2xPC9p3qMvSPaGvaSg6Kap7qarG2stKUXUmPj13rM7Sjad4nq3yLFwEpZBR3rpOfaGwRbOwiJ6xe06cGhvzHPFOUdKiabUyoI/050vjzfeRMuPs2UjMu9DppWFn/0znlSmk4WbdgznLZdug2i/k6NhBmotNOu0GSKeC0cSbi2Z8mSYwVWoH8IFRUD6DXMPKD4wzzPN5ALOx5XeJ5xLrzzgQ8KHTAiJEDOTj0wu4tyImwyjuTJOFh/LS5tohBiIoTBNgWnyT7qwDlBKI6X6R60Xvwt3OSJNYF4uixWpFEY5hkHRXMWF/WXHWZzQViMePSFESqkYY9Bao7XCaI1UDxbPH2rEuowc73T9HqUV++Oeb5uvNO1hz+6wRcgbpRZ8mlY/6utZn5FyetWfXj7GOzd1WvPBXmn77XKywJoRow0551W7NP2Pi/FLLJ8Wrh/2gmI6/gJLN2iUiDnNCwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"network waterfall to show js files requested after HTML is requested\"\n        title=\"network waterfall to show js files requested after HTML is requested\"\n        src=\"/static/4c80cb81af8b0f10293790437d23fff5/a6d36/react-network-waterfall.png\"\n        srcset=\"/static/4c80cb81af8b0f10293790437d23fff5/222b7/react-network-waterfall.png 163w,\n/static/4c80cb81af8b0f10293790437d23fff5/ff46a/react-network-waterfall.png 325w,\n/static/4c80cb81af8b0f10293790437d23fff5/a6d36/react-network-waterfall.png 650w,\n/static/4c80cb81af8b0f10293790437d23fff5/e548f/react-network-waterfall.png 975w,\n/static/4c80cb81af8b0f10293790437d23fff5/3c492/react-network-waterfall.png 1300w,\n/static/4c80cb81af8b0f10293790437d23fff5/92bb4/react-network-waterfall.png 1824w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>This is bad. This means that for our React Application to show up on screen,\nwe will at least need two round trips to the server.\nAfter the receiving the JavaScript file, we still have to run the code\nin order to have our Application mounted. That takes up time as\nwell and it delays our FMP.\nFor such an simple example application, it might not be too much\nof an issue if you are on a desktop computer and a good network.\nHowever, if you are on mobile with lower CPU processing speed,\nit will take much longer to run the React file and mount your\nweb application on. If your network is slow, the 2 round trips\nwill significantly increase FMP as well.</p>\n<p>To solve this issue, we can inline our React script in the HTML file,\nand therefore reducing time for networking. Note: if you use\ncreate-react-app, the script is usually by default inlined.</p>\n<p>This does not solve the issue of time taken to run the JavaScript\nfile. In that case, we might want to switch to server side rendering.\nWe will not go into the details of server side rendering here,\nsince there are a lot of different abstraction and different\nuse cases that requires different types of server side rendering.</p>\n<blockquote>\n<p>What are the issues of server side rendering?</p>\n</blockquote>\n<h2 id=\"optimizing-runtime-of-react-application\" style=\"position:relative;\"><a href=\"#optimizing-runtime-of-react-application\" aria-label=\"optimizing runtime of react application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Optimizing Runtime of React Application</h2>\n<p>Let's say we have simple application that has the following\nstructure.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">increment</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            Count: </span><span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>increment<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Add Count</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyChart</span></span> <span class=\"token attr-name\">title</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>My plot<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n            </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">MyClock</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"/1e31b8de23d663db78765a913a4ed6d4/demo-chart-app.gif\" alt=\"app demo\"></p>\n<p>Look at the <code class=\"language-text\">MyChart</code> component. We can see that it is\na very heavy component. Since it has to draw a lot of\npoints on the graph, which probably takes a lot of time\nfor rendering.\nNow think about what happens when we click the\nbutton to increment the counter.\nReact is going to render the <code class=\"language-text\">App</code> component\nsince the state has been changed.\nThat also means that React has to render the\nchild nodes of <code class=\"language-text\">App</code>, which include the <code class=\"language-text\">button</code>,\n<code class=\"language-text\">MyChart</code> and <code class=\"language-text\">MyClock</code>.</p>\n<p>Here is the implementation of <code class=\"language-text\">MyChart</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyChart</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Charts</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The <code class=\"language-text\">Charts</code> component is what actually draws the plot.\nAssuming that <code class=\"language-text\">Charts</code> is pure (stateless) and all the\ndata is constant. What is the implication of this?\nLet's try to click on the button.</p>\n<p><img src=\"/be34c514c9dcd2d5e6dd3a4a4f3fd918/demo-lag.gif\" alt=\"demo for stuttering app\"></p>\n<p>We see that the clock freezes. Since JavaScript is single\nthreaded, any operation that takes up the CPU is going\nto block other operation. In this scenario, React's process\nof rendering the component is blocking. This is called\n<strong>render blocking</strong>. When we click on the button,\nstate is updated, <code class=\"language-text\">App</code> component and all its children is\nre-rendered. Rendering takes up the CPU time therefore we\ncannot update the animation of the clock since it is blocking.</p>\n<h3 id=\"shouldcomponentupdate-lifecycle-method\" style=\"position:relative;\"><a href=\"#shouldcomponentupdate-lifecycle-method\" aria-label=\"shouldcomponentupdate lifecycle method permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">shouldComponentUpdate</code> Lifecycle Method</h3>\n<p>However, as application developer, we know <code class=\"language-text\">Charts</code> is static\nand <code class=\"language-text\">MyCharts</code> do not need to update if we do not change\n<code class=\"language-text\">props.title</code>. Can we prevent React from re-rendering the\n<code class=\"language-text\">Charts</code> and just use the previously rendered version?\nIn fact, there is a lifecycle method called\n<code class=\"language-text\">shouldComponentUpdate</code> to help you.</p>\n<p>Here is how we use <code class=\"language-text\">shouldComponentUpdate</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyChart</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> prevState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">.</span>title <span class=\"token operator\">===</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Charts</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">shouldComponentUpdate</code> takes in 2 parameters,\nthe previous version of props as <code class=\"language-text\">prevProps</code> and the\nprevious version of state as <code class=\"language-text\">prevState</code>.\nIf the method returns <code class=\"language-text\">true</code>, that means the component\nshould update and React is going to re-render the component.\nOtherwise, the component will not be re-rendered.</p>\n<p>In <code class=\"language-text\">MyChart</code>, the condition to not re-render is that\nif our <code class=\"language-text\">title</code> in the previous props and in our current\n<code class=\"language-text\">props</code> is the same. If they are the same, we return\n<code class=\"language-text\">false</code>.</p>\n<blockquote>\n<p>Why can't we directly do the comparison of <code class=\"language-text\">prevProps === this.props</code>?</p>\n</blockquote>\n<details>\n  <summary>Click to view answer</summary>\n<p>In JavaScript, when objects are being compared, we are\ncomparing their reference. In other words, we are comparing\nthe pointer that points to the object. If the 2 objects\nsit in the same place in memory, the comparison gives <code class=\"language-text\">true</code>.</p>\n<p>However, <code class=\"language-text\">prevProps</code> and <code class=\"language-text\">this.props</code> are two different objects\nat different location in memory. Even if the underneath value\nis the same, we still get <code class=\"language-text\">false</code> when comparing them.</p>\n</details>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3581619105de725ae1ba913f3fae2bde/8e6e2/lifecycle.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.21472392638037%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAABrUlEQVQoz22S647jIAxG5/3fbkadS2+TljQhJOVisIEACatMu7vSas9PS0ffJ9sv9Tc5Z+ccAMzznHNGRGNADIMBY4yJMaaUrLUAEGNclqXW+lJrXde11up94HxgrDUGnHPeB7CWMaa1jjG6H/q+Z4wZY3LOf+Qt2WA8turjPHAZPKG8T+isVspaGMVgjA4hEJEPnohSSpucc1ZSEaFxoeF4FcRGOrfyzKZLr1thuYpXgXdlg/fWbvmI+Ewmovfdrus6H6LUqIE0UC/UZyMO12l/nYTaJgas9/5h/k1eliXGWEohH6RxChDQ3w2dOnM4Dd+tEtorwP/LpZSUUinZWGIj3ibq7uE2YtOKboR+gv7uWmGl3mr/KyMiuzLO+TzHGDbmlOZgMzZ6+Jhur4q/J3eOXsU5ee9DCI+mz4UBABIthda5q4kXfzPjJ8lz0N+Z2lpEjV2O9nGUB085hHDYHzgfKNgj2x0ub3y6IEquLk33tW/eLt3XoBv0MMF0bA+n25HLviw/8rqupZR1XcMcRzUJORoHqWQbnDRSyGlUd/A2ptkiCCmEFNqqx1/9Am0+bwFNpU3pAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"react lifecycle diagram\"\n        title=\"react lifecycle diagram\"\n        src=\"/static/3581619105de725ae1ba913f3fae2bde/a6d36/lifecycle.png\"\n        srcset=\"/static/3581619105de725ae1ba913f3fae2bde/222b7/lifecycle.png 163w,\n/static/3581619105de725ae1ba913f3fae2bde/ff46a/lifecycle.png 325w,\n/static/3581619105de725ae1ba913f3fae2bde/a6d36/lifecycle.png 650w,\n/static/3581619105de725ae1ba913f3fae2bde/e548f/lifecycle.png 975w,\n/static/3581619105de725ae1ba913f3fae2bde/3c492/lifecycle.png 1300w,\n/static/3581619105de725ae1ba913f3fae2bde/8e6e2/lifecycle.png 2438w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>We see that <code class=\"language-text\">shouldComponentUpdate</code> is called right before\n<code class=\"language-text\">render</code> when a component is updating.\nWe \"bail out\" from rendering using <code class=\"language-text\">shouldComponentUpdate</code>.</p>\n<p>Let's retry our demo with the optimization applied.</p>\n<p><img src=\"/ba04a5fd6b49d72eb0248c8c325ae3e1/demo-no-lag.gif\" alt=\"optimized component with high frame rate\"></p>\n<p>This is nice, but also tedious.\nWhat you have a really long list of props?\nThen you might need to manually compare each of them!\nSure you can write a for-loop to help you do that.</p>\n<h3 id=\"reactpurecomponent\" style=\"position:relative;\"><a href=\"#reactpurecomponent\" aria-label=\"reactpurecomponent permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">React.PureComponent</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> prevState</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// compare number of keys</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// compare value of keys</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> key <span class=\"token keyword\">of</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevState<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>But you have to copy this code for each and every component\nthat you are optimizing. That is tedious. However, React\nprovides you with a nice way of skipping this boilerplate.\nInstead of <code class=\"language-text\">React.Component</code>, we use <code class=\"language-text\">React.PureComponent</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyChart</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Charts</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Just as the name suggest, whatever component that you\nbuild with <code class=\"language-text\">PureComponent</code> should be pure. That means\nthe render should return the same tree of component\ngiven the same state and props.</p>\n<blockquote>\n<p>In what situation will choose to implement our own\n<code class=\"language-text\">shouldComponentUpdate</code> instead of using <code class=\"language-text\">PureComponent</code>?</p>\n</blockquote>\n<h3 id=\"reactmemo-for-function-components\" style=\"position:relative;\"><a href=\"#reactmemo-for-function-components\" aria-label=\"reactmemo for function components permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">React.memo</code> for Function Components</h3>\n<p>What if our component is a function component? We cannot\nuse the lifecycle hook. React provides us with <code class=\"language-text\">React.memo</code>\nto go around that issue.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> MyChart <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> title <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Charts</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">React.memo</code> takes in a function component, and check\nif the props and state changes over each render.</p>\n<blockquote>\n<p>With class component, can you implement a simple version\nof <code class=\"language-text\">React.memo</code> that only check if the <code class=\"language-text\">props</code> have updated\nover each render? (No need to check for <code class=\"language-text\">state</code> change)</p>\n</blockquote>\n<details>\n<summary>\nClick to view solution\n</summary>\n<p>The general idea is to take a component, put a wrapper\naround it, and \"hijack\" its props.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">FuncComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemoizedComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n     <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// compare number of keys</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// compare value of keys</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> key <span class=\"token keyword\">of</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevState<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FuncComponent</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> MemoizedComponent<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>You can get lazier, using <code class=\"language-text\">PureComponent</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">function</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">FuncComponent</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">MemoizedComponent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>PureComponent</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">FuncComponent</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token operator\">...</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> MemoizedComponent<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>But this cannot check for the <code class=\"language-text\">state</code> change in\n<code class=\"language-text\">FuncComponent</code>. That is doable but is going to be harder.\nIf you want to try, look into React <code class=\"language-text\">ref</code>.</p>\n</details>","frontmatter":{"date":"2019-11-05T00:00:00.000Z","title":"Optimizing Frontend and React Apps","subtitle":"JavaScript Chats with ACM Hack Session 4","author":null}}},"pageContext":{"slug":"/posts/fall2019/js-chats-4/"}},
    "staticQueryHashes": ["1274017682"]}